apiVersion: 1

deleteDatasources:
{% for service in prometheus_services.json %}
  - id: {{ loop.index }}
{% endfor %}

datasources:
{% for service in prometheus_services.json %}
- name: {{ service.Node }}
  type: prometheus
  orgId: 1
  access: proxy
  url: http://{{ service.ServiceAddress }}:{{ service.ServicePort }}/{{ service.ServiceMeta.path | d("") }}
  withCredentials: false
  isDefault: {{ loop.first }}
  jsonData:
     tlsAuth: false
     tlsAuthWithCACert: false
  version: 1
  editable: true

{% endfor %}
